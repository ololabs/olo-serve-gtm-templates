___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Olo Serve",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAYAAADlEnrIAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAA9qADAAQAAAABAAAA9gAAAADeVEpZAAAhaklEQVR4Ae2dCXRdVbnH9z43SYckQCnQJrkpAjZJLdRiKyigjxRom6GA61GE8gABxRFhoSAq8HA9QRQVUUBAfQhIERVpaZJShhYeQylQQKDDTWVqbkKZ2tox0z37/XdKpE2bnOGefXJuzv+u1ebec/b+9vf99v722fMRgh8SIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESiAYBGQ01qIUfAocuai3v6LJP9hN3oDgJKT5YXVc+d6AwvBdtAnnRVo/aDUSgs0tUCqV+PVAYP/cyQr6KeHRsP/AiEseKiB5UgwRIIEACdOwAYVIUCUSFAB07KjlBPUggQAJ07ABhUhQJRIUAHTsqOUE9SCBAAnTsAGFSFAlEhQAdOyo5QT1IIEACdOwAYVIUCUSFAB07KjlBPUggQAJ07ABhUhQJRIUAHTsqOUE9SCBAAnTsAGFSFAlEhQAdOyo5QT1IIEACdOwAYVIUCUSFAB07KjlBPUggQAJ07ABhUhQJRIUAHTsqOUE9SCBAAnTsAGFSFAlEhQAdOyo5QT1IIEACdOwAYVIUCUSFwJA5zLDyyfeKxTZRLDKdxcKWxdLOFKmE1SWkvVllCrYUWvbmsWLspoW1siMq8KlHeAQmLnm3yO6QxSrTUSyUhX+ZYjsv0S267c1C5m8eauUj544fnvDgeyV2d8cx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2K1wbtINMwwd2z/toV4+Qp/H9p8V3mIOdaf2RoOh+xIY6uVjyDp234zkbxKIEwE6dpxym7bGhgAdOzZZTUPjRICOHafcpq2xIUDHjk1W09A4EaBjxym3aWtsCNCxY5PVNDROBOjYccpt2hobAnTs2GQ1DY0TATp2nHKbtsaGAB07NllNQ+NEgI4dp9ymrbEhQMeOTVbT0DgRoGPHKbdpa2wI0LFjk9U0NE4E6Nhxym3aGhsCdOzYZDUNjRMBOnaccpu2xoYAHTs2WU1D40SAjh2n3KatsSFAx45NVtPQOBGgY8cpt2lrbAjQsWOT1TQ0TgQi9e6uOIEPwtbSwtLH3utIjw5C1s4yiuyR3Tv/5ncSIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAESIAES8Evg/wGCHwbFMTflRAAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Map Olo Serve global events to dataLayer events to use for ecommerce tracking.",
  "containerContexts": [
    "WEB"
  ],
  "categories": [
    "SALES",
    "CONVERSIONS"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "CHECKBOX",
    "name": "enhanced",
    "checkboxText": "Enhanced Ecommerce",
    "simpleValueType": true
  },
  {
    "type": "GROUP",
    "name": "enabledEvents",
    "displayName": "Enabled Events",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "v1.addToCart",
        "checkboxText": "Add to cart",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.removeFromCart",
        "checkboxText": "Remove from cart",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.checkout",
        "checkboxText": "Checkout",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v0.transaction",
        "checkboxText": "Transaction",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": false,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.transaction",
        "checkboxText": "Purchase",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.clickProductLink",
        "checkboxText": "Click product link",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.viewProductDetail",
        "checkboxText": "View product detail",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      },
      {
        "type": "CHECKBOX",
        "name": "v1.productsVisible",
        "checkboxText": "Product impression",
        "simpleValueType": true,
        "enablingConditions": [
          {
            "paramName": "enhanced",
            "paramValue": true,
            "type": "EQUALS"
          }
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const callInWindow = require('callInWindow');
const log = require('logToConsole');
const copyFromWindow = require('copyFromWindow');
const createQueue = require('createQueue');
const Math = require('Math');



/***
 * HELPER FUNCTIONS
 */
const dlp = createQueue('dataLayer');
function dataLayerPush(payload) {
  dlp(payload);
  debugLog('pushing to data layer', payload);
}

function assign() {
  const objects = arguments;
  const len = objects.length;
  const newObject = {};
  for (let i = 0; i < len; i++) {
    for (let key in objects[i]) {
      newObject[key] = objects[i][key];
    }
  }
  return newObject;
}

function keys(obj) {
  const keys = [];
  for (let key in obj) {
    keys.push(key);
  }
  return keys;
}

function roundTo(num, len) {
  len = len || 0;
  len = (Math.floor(num) + '').length + len + 1; // account for the length of the number and the decimal
  return ((num * 1.00000000000000000000001) + '').slice(0, len) * 1;
}

function debugLog(msg, obj) {
  log('Olo Serve GTM: ' + msg);
  if (obj) {
    log(obj);
  }
}

function oloOn(configName, cb) {
  // If this event is enabled, listen for it
  if (data[configName]) {
    callInWindow('Olo.on', configName, cb);
    debugLog('listening for "' + configName + '" events.');
  }
  else {
    debugLog('NOT listening for "' + configName + '" events.');
  }
}

function mapProduct(product) {
  return {
    name: product.name,
    id: product.id,
    price: product.baseCost || 0.0,
    category: product.category.name
  };
}

function mapBasketProduct(bp) {
  return {
    name: bp.productName,
    id: bp.product.id,
    price: bp.unitCost || 0.0,
    quantity: bp.quantity
  };
}

function mapBasketProductLegacy(bp) {
  return {
    sku: bp.product.id,
    name: bp.productName,
    category: bp.categoryName,
    price: bp.unitCost || 0.0,
    quantity: bp.quantity
  };
}

function combineMatchingBasketProductsForEcommerce(basketProducts, key, costKey) {
  key = key || 'id';
  costKey = costKey || 'price';
  const combinedBasketProducts = basketProducts.reduce(function(acc, bp) {
    if (!bp) return acc;
    const cur = acc[bp[key]];
    if (!cur) { // No basket product with this ID, store it an continue
      acc[bp[key]] = bp;
      return acc;
    }

    // Combine this basket product with the last one
    // `price` is a per-unit price, and because different instances of the same ID
    // can have different prices (due to modifiers being added), we do our best
    // and find an average price per unit so that the Google Analytics revenue is correct.
    // Calculate the new average price by taking the current price and quantity for this item,
    // multiplying it out to the total cost, adding the total cost of the new item, and averaging
    // both the existing total cost and the new total cost by the new quantity and rounding to two decimal places.
    const newQuantity = cur.quantity + bp.quantity;
    const newAveragePrice =
      Math.round(100 * ((cur[costKey] * cur.quantity + bp[costKey] * bp.quantity) / newQuantity)) / 100;
    acc[bp[key]] = assign(
      cur,
      {
        price: newAveragePrice,
        quantity: newQuantity
      }
    );

    return acc;
  }, {});

  return keys(combinedBasketProducts).map(function(k) {
    return assign(
      combinedBasketProducts[k],
      {
        price: roundTo(combinedBasketProducts[k].price, 2)
      }
    );
  });
}

function getVendor() {
  return copyFromWindow('Olo.data.vendor') || {};
}




/**
 * EVENT LISTENERS
 */
oloOn('v1.addToCart', function(product) {
  dataLayerPush({
    event: 'addToCart',
    ecommerce: {
      currencyCode: getVendor().currency,
      add: {
        products: [mapBasketProduct(product)]
      }
    }
  });
});

oloOn('v1.removeFromCart', function(product) {
  dataLayerPush({
    event: 'removeFromCart',
    ecommerce: {
      currencyCode: getVendor().currency,
      remove: {
        products: [mapBasketProduct(product)]
      }
    }
  });
});

oloOn('v1.checkout', function(basket, cb) {
  dataLayerPush({
    event: 'checkout',
    ecommerce: {
      checkout: {
        actionField: { step: 0 },
        products: basket.basketProducts.map(mapBasketProduct)
      },
      eventCallback: cb || function() {}
    }
  });
});

oloOn('v1.transaction', function(order, orderSubmission) {
  dataLayerPush({
    event: 'purchase',
    ecommerce: {
      purchase: {
        actionField: {
          id: order.displayId,
          affiliation: order.deliveryMode,
          revenue: order.subTotal,
          tax: order.vendorTax,
          shipping: order.deliveryCharge,
          coupon: orderSubmission.basket.coupon
        },
        products: combineMatchingBasketProductsForEcommerce(
          order.basketProducts.map(mapBasketProduct)
        )
      }
    }
  });
});

oloOn('v0.transaction', function(order, orderSubmission) {
  dataLayerPush({
    transactionId: order.id,
    transactionAffiliation: order.vendorName,
    transactionTotal: roundTo(order.vendorTotal || 0, 2),
    transactionTax: roundTo(order.vendorTax || 0, 2),
    transactionShipping: order.deliveryCharge,
    transactionZipCode: order.vendor.address ? order.vendor.address.postalCode : undefined,
    transactionStoreNumber: order.vendor.id,
    transactionStoreReference: order.vendor.externalReference,
    transactionProducts: combineMatchingBasketProductsForEcommerce(order.basketProducts.map(mapBasketProductLegacy), 'sku'),
    transactionHandoff: order.handoffDescription,
    transactionRevenue: roundTo(order.subTotal || 0, 2),
    transactionCurrency: getVendor().currency
  });
});

oloOn('v1.clickProductLink', function(product, clickFrom) {
  dataLayerPush({
    event: 'clickProductLink',
    ecommerce: {
      click: {
        actionField: {list: clickFrom},
        products: [mapProduct(product)]
      }
    }
  });
});

oloOn('v1.viewProductDetail', function(product, viewIn) {
  dataLayerPush({
    event: 'viewProductDetail',
    ecommerce: {
      detail: {
        actionField: {list: viewIn},
        products: [mapProduct(product)]
      }
    }
  });
});

oloOn('v1.productsVisible', function(products) {
  dataLayerPush({
    event: 'productsVisible',
    ecommerce: {
      currencyCode: getVendor().currency,
      impressions: products.map(mapProduct)
    }
  });
});





/**
 * TAG IS FINISHED SETTING UP
 */
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Olo.on"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Olo.data.vendor"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Pushes to dataLayer
  code: |
    test('it pushes to dataLayer', function(run) {
      const t = run();
      assertThat(t.queueName).isEqualTo('dataLayer');
    });
- name: Registers events
  code: "test('it registers enabled events', function(run) {\n  const t = run({\n\
    \    'v1.addToCart': true, \n    'v1.removeFromCart': true,\n    'v1.checkout':\
    \ true,\n    'v1.transaction': true,\n    'v1.clickProductLink': true,\n    'v1.viewProductDetail':\
    \ true,\n    'v1.productsVisible': true\n  });\n  assertThat(t.events).contains('v1.addToCart');\n\
    \  assertThat(t.events).contains('v1.removeFromCart');\n  assertThat(t.events).contains('v1.checkout');\n\
    \  assertThat(t.events).contains('v1.transaction');\n  assertThat(t.events).contains('v1.clickProductLink');\n\
    \  assertThat(t.events).contains('v1.viewProductDetail');\n  assertThat(t.events).contains('v1.productsVisible');\n\
    });\n\ntest('it does not register disabled events', function(run) {\n  const t\
    \ = run();\n  assertThat(t.events).doesNotContain('v1.addToCart');\n  assertThat(t.events).doesNotContain('v1.removeFromCart');\n\
    \  assertThat(t.events).doesNotContain('v1.checkout');\n  assertThat(t.events).doesNotContain('v1.transaction');\n\
    \  assertThat(t.events).doesNotContain('v1.clickProductLink');\n  assertThat(t.events).doesNotContain('v1.viewProductDetail');\n\
    \  assertThat(t.events).doesNotContain('v1.productsVisible');\n});\n\ntest('it\
    \ registers the legacy transaction listener', function(run) {\n  const t = run({'v0.transaction':\
    \ true});\n  assertThat(t.events).contains('v0.transaction');\n});"
- name: Tag setup completes
  code: |-
    test('it completes setup', function(run) {
      run();
      assertApi('gtmOnSuccess').wasCalled();
    });
- name: Add to cart
  code: "test('it adds to cart', function(run) {\n  const t = run({'v1.addToCart':\
    \ true});\n\n  t.callbacks['v1.addToCart'](mockBasketProduct);\n\n  // Verify\
    \ that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'addToCart',\n    ecommerce: {\n      currencyCode: 'USD',\n     \
    \ add: {                                \n        products: [{               \
    \        \n          name: 'Test Product',\n          id: 1234,\n          price:\
    \ 15.87,\n          quantity: 2\n        }]\n      }\n    }\n  });\n});"
- name: Remove from cart
  code: "test('it removes from cart', function(run) {\n  const t = run({'v1.removeFromCart':\
    \ true});\n\n  t.callbacks['v1.removeFromCart'](mockBasketProduct);\n\n  // Verify\
    \ that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'removeFromCart',\n    ecommerce: {\n      currencyCode: 'USD',\n\
    \      remove: {                                \n        products: [{       \
    \                \n          name: 'Test Product',\n          id: 1234,\n    \
    \      price: 15.87,\n          quantity: 2\n        }]\n      }\n    }\n  });\n\
    });"
- name: Checkout
  code: "test('it handles checkout', function(run) {\n  const t = run({'v1.checkout':\
    \ true});\n\n  t.callbacks['v1.checkout'](mockBasket, noop);\n\n  // Verify that\
    \ the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'checkout',\n    ecommerce: {\n      checkout: {  \n        actionField:\
    \ { step: 0 },\n        products: [{                       \n          name: 'Test\
    \ Product',\n          id: 1234,\n          price: 15.87,\n          quantity:\
    \ 2\n        }]\n      },\n      eventCallback: noop\n    }\n  });\n});"
- name: Purchase
  code: "test('it handles transaction', function(run) {\n  const t = run({'v1.transaction':\
    \ true});\n\n  t.callbacks['v1.transaction'](mockOrder, mockOrderSubmission);\n\
    \n  // Verify that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'purchase',\n    ecommerce: {\n      purchase: {  \n        actionField:\
    \ {\n          id: 'asdf',\n          affiliation: 'Pickup',\n          revenue:\
    \ 14.98,\n          tax: 0.72,\n          shipping: 5.99,\n          coupon: 'FREEBIE'\n\
    \        },\n        products: [{\n          name: 'Test Product',\n         \
    \ id: 1234,\n          price: 17.93,\n          quantity: 5\n        }, {\n  \
    \        name: 'Test Product 2',\n          id: 1235,\n          price: 3.99,\n\
    \          quantity: 1\n        }]\n      }\n    }\n  });\n});"
- name: Transaction (Legacy)
  code: |-
    test('it handles legacy ecommerce transaction', function(run) {
      const t = run({'v0.transaction': true});

      t.callbacks['v0.transaction'](mockOrder, mockOrderSubmission);

      // Verify that the dataLayer received the right stuff
      assertThat(t.dataLayer[0]).isEqualTo({
        transactionId: 1234,
        transactionAffiliation: "Fakes's Tavern",
        transactionTotal: 15.69,
        transactionTax: 0.72,
        transactionShipping: 5.99,
        transactionZipCode: '48104',
        transactionStoreNumber: 'testVendor',
        transactionStoreReference: 'Test Store #37',
        transactionProducts: [{
          name: 'Test Product',
          sku: 1234,
          price: 17.93,
          quantity: 5,
          category: 'Pasta'
        }, {
          name: 'Test Product 2',
          sku: 1235,
          price: 3.99,
          quantity: 1,
          category: 'Pasta'
        }],
        transactionHandoff: 'Curbside Pickup',
        transactionRevenue: 14.98,
        transactionCurrency: 'USD'
      });
    });
- name: Click product link
  code: "test('it handles clicking a product link', function(run) {\n  const t = run({'v1.clickProductLink':\
    \ true});\n\n  t.callbacks['v1.clickProductLink'](mockProduct, 'vendor-menu');\n\
    \n  // Verify that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'clickProductLink',\n    ecommerce: {\n      click: {  \n        actionField:\
    \ { list: 'vendor-menu' },\n        products: [{                       \n    \
    \      name: 'Test Product',\n          id: 1234,\n          price: 15.99,\n \
    \         category: 'Test Category'\n        }]\n      }\n    }\n  });\n});"
- name: View product details
  code: "test('it handles viewing product details', function(run) {\n  const t = run({'v1.viewProductDetail':\
    \ true});\n\n  t.callbacks['v1.viewProductDetail'](mockProduct, 'modal');\n\n\
    \  // Verify that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'viewProductDetail',\n    ecommerce: {\n      detail: {  \n      \
    \  actionField: { list: 'modal' },\n        products: [{                     \
    \  \n          name: 'Test Product',\n          id: 1234,\n          price: 15.99,\n\
    \          category: 'Test Category'\n        }]\n      }\n    }\n  });\n});"
- name: Products visible
  code: "test('it handles an impression on a product', function(run) {\n  const t\
    \ = run({'v1.productsVisible': true});\n\n  t.callbacks['v1.productsVisible']([mockProduct]);\n\
    \n  // Verify that the dataLayer received the right stuff\n  assertThat(t.dataLayer[0]).isEqualTo({\n\
    \    event: 'productsVisible',\n    ecommerce: {\n      currencyCode: 'USD',\n\
    \      impressions: [{                       \n        name: 'Test Product',\n\
    \        id: 1234,\n        price: 15.99,\n        category: 'Test Category'\n\
    \      }]\n    }\n  });\n});"
setup: "const log = require('logToConsole');\n\nconst mockBasketProduct = {      \
  \                 \n  productName: 'Test Product',\n  categoryName: 'Pasta',\n \
  \ unitCost: 15.87,\n  quantity: 2,\n  product: {\n    id: 1234\n  }\n};\n\nconst\
  \ mockBasketProduct2 = {                       \n  productName: 'Test Product 2',\n\
  \  categoryName: 'Pasta',\n  unitCost: 3.99,\n  quantity: 1,\n  product: {\n   \
  \ id: 1235\n  }\n};\n\nconst mockBasketProduct3 = {                       \n  productName:\
  \ 'Test Product',\n  categoryName: 'Pasta',\n  unitCost: 19.31,\n  quantity: 3,\n\
  \  product: {\n    id: 1234\n  }\n};\n\nconst mockProduct = {                  \
  \     \n  name: 'Test Product',\n  baseCost: 15.99,\n  id: 1234,\n  category: {\n\
  \    name: 'Test Category',\n    description: 'Lorem, dawg.'\n  }\n};\n\nconst mockBasket\
  \ = {\n  basketProducts: [mockBasketProduct]\n};\n\nconst mockOrder = {\n  basketProducts:\
  \ [mockBasketProduct, mockBasketProduct2, mockBasketProduct3],\n  id: 1234,\n  displayId:\
  \ 'asdf',\n  deliveryMode: 'Pickup',\n  handoffDescription: 'Curbside Pickup',\n\
  \  subTotal: 14.98,\n  vendorTax: 0.72,\n  deliveryCharge: 5.99,\n  vendorTotal:\
  \ 15.69999999,\n  vendorName: \"Fakes's Tavern\",\n  vendor: {\n    id: 'testVendor',\n\
  \    externalReference: 'Test Store #37',\n    address: {\n      postalCode: '48104'\n\
  \    }\n  }\n};\n\nconst mockOrderSubmission = {\n  basket: {\n    coupon: 'FREEBIE'\n\
  \  }\n};\n\nconst noop = function() {};\n\nfunction test(name, cb) {\n  cb(function(data)\
  \ {\n    const dataLayer = [];\n    const events = [];\n    const callbacks = {};\n\
  \    let queueName;\n\n    // Mock vendor return\n    mock('copyFromWindow', {currency:\
  \ 'USD'});\n\n    // Mock creating a data layer\n    mock('createQueue', function(q)\
  \ {\n      queueName = q;\n      return function(d) {\n        dataLayer.push(d);\n\
  \      };\n    });\n\n\n    mock('callInWindow', function(_, eName, cb) {\n    \
  \  cb = cb || noop;\n      events.push(eName);\n      callbacks[eName] = cb;\n \
  \   });\n\n    runCode(data || {});\n\n    log('Running test: ' + name);\n    \n\
  \    return {\n      events: events,\n      callbacks: callbacks,\n      dataLayer:\
  \ dataLayer,\n      queueName: queueName\n    };\n  });\n}"


___NOTES___

Created on 9/26/2020, 7:57:35 AM


